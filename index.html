<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        (function() {
            var t = localStorage.getItem('theme');
            var d = window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.documentElement.setAttribute('data-theme', (t === 'dark' || (!t && d)) ? 'dark' : 'light');
        })();
    </script>
    <title>Foldproof - 3D Print Fold Preview | Brochure & Flyer Layout Visualizer</title>
    <meta name="description" content="Preview print layouts in 3D with Foldproof. Upload front and back designs, choose bi-fold, tri-fold, or gate fold styles, and see an interactive 3D preview before printing. Supports PDF, images, custom sizes, bleed guides, and export to JPG, PNG, or PDF.">
    <meta name="keywords" content="print preview, brochure fold, tri-fold, bi-fold, gate fold, 3D print layout, flyer design, PDF preview, print design tool">
    <meta name="author" content="Foldproof">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://tyler-fulk.github.io/Foldproof/">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Foldproof - 3D Print Fold Preview">
    <meta property="og:description" content="Preview brochure and flyer layouts in interactive 3D. Upload designs, choose fold types, and export before printing. Free web-based print preview tool.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tyler-fulk.github.io/Foldproof/">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Foldproof - 3D Print Fold Preview">
    <meta name="twitter:description" content="Preview brochure and flyer layouts in interactive 3D. Upload designs, choose fold types, and export before printing.">
    
    <link rel="stylesheet" href="css/styles.css">
    <link rel="icon" type="image/png" href="assets/favicon.png">
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Foldproof",
        "description": "Free web-based 3D print fold preview tool. Upload front and back designs, visualize bi-fold, tri-fold, and gate fold layouts in an interactive 3D viewport, then export to JPG, PNG, or PDF before printing.",
        "url": "https://tyler-fulk.github.io/Foldproof/",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Any",
        "browserRequirements": "Requires JavaScript. Supports Chrome, Firefox, Safari, Edge.",
        "featureList": [
            "Upload front and back images (PNG, JPG, WebP, PDF)",
            "Preset and custom paper sizes with fractional inch support",
            "Bi-fold, tri-fold Z-fold, tri-fold roll, and gate fold styles",
            "Vertical and horizontal orientation for all fold types",
            "Interactive 3D viewport with orbit controls",
            "Animated fold/unfold preview with adjustable speed",
            "Print guides: trim line, bleed area, safe zone, fold lines",
            "Ruler with measurement labels",
            "Export viewport to JPG, PNG (transparent), or PDF",
            "Light and dark mode"
        ]
    }
    </script>
</head>
<body>
    <noscript>
        <div style="padding: 20px; text-align: center; background: #fef3c7; color: #92400e;">
            Foldproof requires JavaScript to run. Please enable JavaScript in your browser to preview 3D print fold layouts.
        </div>
    </noscript>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>Foldproof</h1>
                <div class="header-buttons">
                    <button id="theme-toggle" class="icon-btn" title="Toggle Dark/Light Mode">
                        <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></svg>
                        <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                    </button>
                    <button id="help-toggle" class="icon-btn" title="Help">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
                    </button>
                </div>
            </div>

            <!-- Image Upload Section -->
            <section class="panel">
                <h2>Upload Images</h2>
                
                <div class="upload-group">
                    <label>Front Side</label>
                    <div class="upload-zone" id="front-upload-zone" data-side="front">
                        <input type="file" id="front-image" accept="image/*,.pdf" hidden>
                        <div class="upload-placeholder">
                            <span class="upload-icon">ðŸ“„</span>
                            <span class="upload-text">Drop front image or PDF<br>or click to browse</span>
                        </div>
                        <div class="upload-preview" hidden>
                            <img id="front-preview" alt="Front preview">
                            <div class="page-selector-wrap" id="front-page-selector" hidden></div>
                            <button type="button" class="remove-btn" data-side="front" title="Remove" onclick="event.stopPropagation(); window.removeUploadedImage('front');">Ã—</button>
                        </div>
                    </div>
                </div>

                <div class="upload-zones-gap">
                    <label class="upload-label">Back Side</label>
                    <div class="swap-images-wrap">
                        <button type="button" id="swap-images-btn" class="swap-images-btn" title="Swap front and back">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M7 15l5 5 5-5M7 9l5-5 5 5"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="upload-group">
                    <div class="upload-zone" id="back-upload-zone" data-side="back">
                        <input type="file" id="back-image" accept="image/*,.pdf" hidden>
                        <div class="upload-placeholder">
                            <span class="upload-icon">ðŸ“„</span>
                            <span class="upload-text">Drop back image or PDF<br>or click to browse</span>
                        </div>
                        <div class="upload-preview" hidden>
                            <img id="back-preview" alt="Back preview">
                            <div class="page-selector-wrap" id="back-page-selector" hidden></div>
                            <button type="button" class="remove-btn" data-side="back" title="Remove" onclick="event.stopPropagation(); window.removeUploadedImage('back');">Ã—</button>
                        </div>
                    </div>
                </div>

                <label class="toggle-item" style="margin-top: 12px;">
                    <input type="checkbox" id="autofit-image">
                    <span class="toggle-label">Autofit image</span>
                    <span class="autofit-tooltip-wrap" id="autofit-tooltip-trigger">
                        <span class="autofit-tooltip">?</span>
                        <span class="autofit-tooltip-box" id="autofit-tooltip-box"><strong>Enabled:</strong> Paper size uses your preset or custom dimensions.<br><br><strong>Disabled:</strong> Paper size is taken from the uploaded file (e.g. a 1â€³Ã—1â€³ PDF displays at 1â€³Ã—1â€³).</span>
                    </span>
                </label>

                <div class="panel-subsection reflect-subsection">
                    <h3 class="subsection-heading">Flip Images</h3>
                    <div class="reflect-section">
                    <div class="reflect-row">
                        <span class="reflect-row-label">Front Image</span>
                        <div class="reflect-buttons">
                            <label class="reflect-btn" title="Flip front horizontally">
                                <input type="checkbox" id="reflect-front-h">
                                <span class="reflect-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M8 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3"/>
                                        <path d="M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3"/>
                                        <path d="M12 3v18" stroke-dasharray="2 2"/>
                                        <path d="M7 8l-3 4 3 4"/>
                                        <path d="M17 8l3 4-3 4"/>
                                    </svg>
                                </span>
                            </label>
                            <label class="reflect-btn" title="Flip front vertically">
                                <input type="checkbox" id="reflect-front-v">
                                <span class="reflect-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M3 8V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v3"/>
                                        <path d="M3 16v3a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-3"/>
                                        <path d="M3 12h18" stroke-dasharray="2 2"/>
                                        <path d="M8 7l4-3 4 3"/>
                                        <path d="M8 17l4 3 4-3"/>
                                    </svg>
                                </span>
                            </label>
                        </div>
                    </div>
                    <div class="reflect-row">
                        <span class="reflect-row-label">Back Image</span>
                        <div class="reflect-buttons">
                            <label class="reflect-btn" title="Flip back horizontally">
                                <input type="checkbox" id="reflect-back-h" checked>
                                <span class="reflect-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M8 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3"/>
                                        <path d="M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3"/>
                                        <path d="M12 3v18" stroke-dasharray="2 2"/>
                                        <path d="M7 8l-3 4 3 4"/>
                                        <path d="M17 8l3 4-3 4"/>
                                    </svg>
                                </span>
                            </label>
                            <label class="reflect-btn" title="Flip back vertically">
                                <input type="checkbox" id="reflect-back-v">
                                <span class="reflect-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M3 8V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v3"/>
                                        <path d="M3 16v3a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-3"/>
                                        <path d="M3 12h18" stroke-dasharray="2 2"/>
                                        <path d="M8 7l4-3 4 3"/>
                                        <path d="M8 17l4 3 4-3"/>
                                    </svg>
                                </span>
                            </label>
                        </div>
                    </div>
                    </div>
                </div>
            </section>

            <!-- Size Selection Section -->
            <section class="panel">
                <h2>Paper Size</h2>
                
                <div class="form-group">
                    <label for="size-preset">Preset Sizes</label>
                    <select id="size-preset">
                        <option value="letter">8.5" Ã— 11" (Letter)</option>
                        <option value="legal">8.5" Ã— 14" (Legal)</option>
                        <option value="tabloid">11" Ã— 17" (Tabloid)</option>
                        <option value="a4">210mm Ã— 297mm (A4)</option>
                        <option value="a3">297mm Ã— 420mm (A3)</option>
                        <option value="custom">Custom Size...</option>
                    </select>
                </div>

                <div class="form-row custom-size-inputs" id="custom-size-section" hidden>
                    <div class="form-group">
                        <label for="custom-width">Width</label>
                        <input type="text" id="custom-width" placeholder='e.g., 16 5/16"'>
                    </div>
                    <div class="form-group">
                        <label for="custom-height">Height</label>
                        <input type="text" id="custom-height" placeholder='e.g., 8 7/16"'>
                    </div>
                    <button id="apply-custom-size" class="btn btn-secondary">Apply</button>
                </div>

                <div class="size-display">
                    <span id="current-size">8.5" Ã— 11"</span>
                </div>
            </section>

            <!-- Fold Type Section -->
            <section class="panel">
                <h2>Fold Type</h2>
                
                <div class="form-group">
                    <label for="fold-type">Fold Style</label>
                    <select id="fold-type">
                        <option value="bi-fold">Bi-Fold</option>
                        <option value="tri-fold-z">Tri-Fold Z-Fold (Accordion)</option>
                        <option value="tri-fold-roll">Tri-Fold Roll (Letter)</option>
                        <option value="gate-fold">Gate Fold</option>
                        <option value="double-gate-fold">Double Gate Fold</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="fold-orientation">Orientation</label>
                    <select id="fold-orientation">
                        <option value="vertical">Vertical (Left-Right fold)</option>
                        <option value="horizontal">Horizontal (Top-Bottom fold)</option>
                    </select>
                </div>
            </section>

            <!-- Guides Section -->
            <section class="panel">
                <h2>Guides</h2>
                
                <div class="guide-toggles">
                    <label class="toggle-item">
                        <input type="checkbox" id="guide-trim" checked>
                        <span class="toggle-label">
                            <span class="guide-color trim"></span>
                            Trim Line
                        </span>
                    </label>
                    
                    <label class="toggle-item">
                        <input type="checkbox" id="guide-bleed">
                        <span class="toggle-label">
                            <span class="guide-color bleed"></span>
                            Bleed Area
                        </span>
                    </label>
                    
                    <div class="toggle-submenu" id="bleed-submenu" hidden>
                        <div class="sub-item slider-row">
                            <label for="bleed-margin"><span id="bleed-value">0.125</span>"</label>
                            <input type="range" id="bleed-margin" min="0" max="0.5" step="0.01" value="0.125">
                        </div>
                    </div>
                    
                    <label class="toggle-item">
                        <input type="checkbox" id="guide-safe">
                        <span class="toggle-label">
                            <span class="guide-color safe"></span>
                            Safe Zone
                        </span>
                    </label>
                    
                    <div class="toggle-submenu" id="safe-submenu" hidden>
                        <div class="sub-item slider-row">
                            <label for="safe-margin"><span id="safe-value">0.25</span>"</label>
                            <input type="range" id="safe-margin" min="0" max="1" step="0.01" value="0.25">
                        </div>
                    </div>
                    
                    <label class="toggle-item">
                        <input type="checkbox" id="guide-folds" checked>
                        <span class="toggle-label">
                            <span class="guide-color folds"></span>
                            Fold Lines
                        </span>
                    </label>
                    
                    <label class="toggle-item">
                        <input type="checkbox" id="guide-ruler">
                        <span class="toggle-label">
                            <span class="guide-color ruler"></span>
                            Ruler
                        </span>
                    </label>
                    
                    <div class="toggle-submenu" id="ruler-submenu" hidden>
                        <label class="toggle-item sub-item">
                            <input type="checkbox" id="guide-ruler-labels" checked>
                            <span class="toggle-label">
                                Show Measurements
                            </span>
                        </label>
                    </div>
                    
                    <label class="toggle-item">
                        <input type="checkbox" id="guide-grid" checked>
                        <span class="toggle-label">
                            <span class="guide-color grid"></span>
                            Grid
                        </span>
                    </label>
                </div>
            </section>

            <section class="panel about-panel" id="about-panel">
                <button type="button" class="about-toggle" id="about-toggle" aria-expanded="false">
                    <h2>About & Privacy</h2>
                    <span class="about-chevron">â–¾</span>
                </button>
                <div class="about-content" id="about-content" hidden>
                    <p class="about-intro">Foldproof lets you preview print layouts in 3D before sending to the printer.</p>
                    <ul class="about-features">
                        <li><strong>Upload designs</strong> â€” Front and back images or PDFs (PNG, JPG, WebP, SVG)</li>
                        <li><strong>Paper sizes</strong> â€” Letter, Legal, Tabloid, A4, A3, or custom dimensions</li>
                        <li><strong>Fold types</strong> â€” Bi-fold, tri-fold (Z-fold or roll), gate fold</li>
                        <li><strong>3D preview</strong> â€” Rotate, zoom, and animate fold/unfold</li>
                        <li><strong>Print guides</strong> â€” Trim, bleed, safe zone, fold lines, ruler</li>
                        <li><strong>Export</strong> â€” Save viewport as JPG, PNG (transparent), or PDF</li>
                    </ul>
                    
                    <h3 class="about-subheading">Privacy & Data</h3>
                    <p class="about-privacy">Foldproof runs entirely in your browser. <strong>No data is collected, stored, or transmitted to any server.</strong></p>
                    <ul class="about-features">
                        <li><strong>Your files stay local</strong> â€” Uploaded images and PDFs are processed client-side only and never leave your device</li>
                        <li><strong>No accounts or tracking</strong> â€” No sign-ups, no analytics, no cookies for tracking</li>
                        <li><strong>Local storage</strong> â€” Only your theme preference (light/dark) is saved in your browser's localStorage</li>
                        <li><strong>No data retention</strong> â€” Refreshing or closing the page clears all uploaded content from memory</li>
                    </ul>
                    <p class="about-disclaimer"><em>Disclaimer: This tool is provided "as is" for preview purposes. Always verify final print output with your printer. The developer assumes no responsibility for print errors or file compatibility issues.</em></p>
                </div>
            </section>

            <section class="panel donation-panel">
                <a href="https://ko-fi.com/tylerfulk" target="_blank" class="kofi-button">
                    <span class="kofi-icon">â˜•</span>
                    <span>Saved a reprint? Support the app.</span>
                </a>
                <p class="made-by">Made by <a href="https://tylerfulk.com" target="_blank" rel="noopener">Tyler Fulk</a></p>
            </section>
        </aside>

        <!-- Main Viewport -->
        <main class="viewport">
            <div class="viewport-container">
                <canvas id="three-canvas"></canvas>
                <div class="fold-viewport-toolbar">
                    <div class="fold-type-toolbar" id="fold-type-toolbar">
                        <button type="button" class="fold-type-btn" data-fold="bi-fold" title="Bi-Fold">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="10" height="16" rx="1"/><rect x="12" y="4" width="10" height="16" rx="1"/></svg>
                        </button>
                        <button type="button" class="fold-type-btn" data-fold="tri-fold-z" title="Tri-Fold Z-Fold (Accordion)">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="6" height="16" rx="1"/><rect x="9" y="4" width="6" height="16" rx="1"/><rect x="16" y="4" width="6" height="16" rx="1"/></svg>
                        </button>
                        <button type="button" class="fold-type-btn" data-fold="tri-fold-roll" title="Tri-Fold Roll (Letter)">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="7" height="16" rx="1"/><rect x="9" y="4" width="6" height="16" rx="1"/><rect x="15" y="4" width="7" height="16" rx="1"/></svg>
                        </button>
                        <button type="button" class="fold-type-btn" data-fold="gate-fold" title="Gate Fold">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="6" height="16" rx="1"/><rect x="8" y="4" width="8" height="16" rx="1"/><rect x="16" y="4" width="6" height="16" rx="1"/></svg>
                        </button>
                        <button type="button" class="fold-type-btn" data-fold="double-gate-fold" title="Double Gate Fold">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="5" height="16" rx="0.5" stroke-dasharray="2"/><rect x="6.5" y="4" width="5" height="16" rx="0.5"/><rect x="12" y="4" width="5" height="16" rx="0.5"/><rect x="17.5" y="4" width="5" height="16" rx="0.5" stroke-dasharray="2"/></svg>
                        </button>
                    </div>
                    <div class="fold-orientation-toolbar">
                        <button type="button" class="orientation-btn" data-orientation="vertical" title="Vertical (Left-Right fold)">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="4" y="2" width="8" height="20" rx="1"/><rect x="12" y="2" width="8" height="20" rx="1"/></svg>
                            <span>Vertical</span>
                        </button>
                        <button type="button" class="orientation-btn" data-orientation="horizontal" title="Horizontal (Top-Bottom fold)">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="2" y="4" width="20" height="8" rx="1"/><rect x="2" y="12" width="20" height="8" rx="1"/></svg>
                            <span>Horizontal</span>
                        </button>
                    </div>
                </div>
                <div class="viewport-overlay" id="viewport-overlay">
                    <div class="viewport-overlay-content">
                        <span>Upload front and back images to preview</span>
                        <span class="viewport-overlay-hint">3D print fold preview â€” brochures, flyers, business cards</span>
                    </div>
                </div>
                
                <div class="export-toolbar">
                    <div class="export-btn-wrap">
                        <button type="button" id="screenshot-btn" class="export-btn" title="Capture viewport">Screenshot</button>
                        <div class="export-dropdown" id="screenshot-dropdown" hidden>
                        <div class="export-option">
                            <label>Format</label>
                            <select id="export-format">
                                <option value="jpg">JPG</option>
                                <option value="png">PNG (transparent)</option>
                                <option value="pdf">PDF</option>
                                <option value="gif">Animated GIF</option>
                            </select>
                        </div>
                        <div class="export-option">
                            <label class="toggle-item">
                                <input type="checkbox" id="export-background" checked>
                                <span class="toggle-label">Show background</span>
                            </label>
                        </div>
                        <div class="export-option">
                            <label class="toggle-item">
                                <input type="checkbox" id="export-grid" checked>
                                <span class="toggle-label">Show grid</span>
                            </label>
                        </div>
                        <div class="export-option">
                            <label class="toggle-item">
                                <input type="checkbox" id="export-guides" checked>
                                <span class="toggle-label">Show guides & rulers</span>
                            </label>
                        </div>
                        <button type="button" id="screenshot-apply" class="btn btn-primary">Capture</button>
                        </div>
                    </div>
                    <button type="button" id="export-btn" class="export-btn" title="Export source images">Export</button>
                </div>
            </div>

            <!-- Animation Controls -->
            <div class="controls-bar-wrapper">
                <div class="controls-bar controls-disabled" id="controls-bar">
                    <div class="controls-left">
                    <button id="btn-unfold" class="btn btn-primary" title="Unfold">
                        <svg class="control-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
                        <span>Unfold</span>
                    </button>
                    <button id="btn-fold" class="btn btn-primary" title="Fold">
                        <svg class="control-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
                        <span>Fold</span>
                    </button>
                    <button id="btn-play-pause" class="btn btn-secondary btn-play-pause" title="Play/Pause Animation">
                        <span id="play-icon">
                            <svg class="control-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M9 6v12l9-6z" transform="translate(-1, 0)"/></svg>
                        </span>
                        <span id="pause-icon" hidden>
                            <svg class="control-icon" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="6" y="5" width="4" height="14" rx="1"/><rect x="14" y="5" width="4" height="14" rx="1"/></svg>
                        </span>
                    </button>
                </div>

                <div class="controls-center">
                    <label for="fold-progress">Fold Progress</label>
                    <input type="range" id="fold-progress" min="-100" max="100" value="0">
                    <span id="fold-progress-label">0%</span>
                </div>

                <div class="controls-right">
                    <label for="animation-speed">Speed</label>
                    <input type="range" id="animation-speed" min="0.1" max="3" step="0.1" value="1">
                    <span id="speed-label">1x</span>
                </div>
                </div>
                <div class="controls-bar-overlay" id="controls-bar-overlay" aria-hidden="true"></div>
            </div>
        </main>
    </div>

    <!-- Export Source Images Modal -->
    <div id="source-export-modal" class="modal" hidden>
        <div class="modal-overlay" id="source-export-overlay"></div>
        <div class="modal-content source-export-modal-content">
            <button class="modal-close" id="source-export-close" title="Close">&times;</button>
            <h2>Export Source Images</h2>
            <p class="source-export-intro">Export full-resolution images with transformations applied. Useful for quick prepress edits without dedicated software.</p>
            
            <div class="source-export-form">
                <div class="source-export-row">
                    <label for="source-export-format">Format</label>
                    <select id="source-export-format">
                        <option value="png">PNG</option>
                        <option value="jpg">JPG</option>
                        <option value="pdf">PDF</option>
                    </select>
                </div>
                
                <div class="source-export-row" id="source-export-output-row">
                    <label>Output</label>
                    <div class="source-export-output-options">
                        <label class="toggle-item">
                            <input type="radio" name="source-export-output" value="multiple" checked>
                            <span class="toggle-label">Separate files (front, back)</span>
                        </label>
                        <label class="toggle-item" id="source-export-combined-wrap" style="display: none;">
                            <input type="radio" name="source-export-output" value="combined">
                            <span class="toggle-label">Single PDF (front + back pages)</span>
                        </label>
                    </div>
                </div>

                <div class="source-export-transform-section">
                    <h3>Front Image</h3>
                    <div class="source-export-transform-row">
                        <label class="toggle-item">
                            <input type="checkbox" id="source-front-flip-h">
                            <span class="toggle-label">Flip horizontal</span>
                        </label>
                        <label class="toggle-item">
                            <input type="checkbox" id="source-front-flip-v">
                            <span class="toggle-label">Flip vertical</span>
                        </label>
                        <label class="toggle-item">
                            <span class="toggle-label">Rotate:</span>
                            <select id="source-front-rotate">
                                <option value="0">0Â°</option>
                                <option value="90">90Â° CW</option>
                                <option value="180">180Â°</option>
                                <option value="-90">90Â° CCW</option>
                            </select>
                        </label>
                    </div>
                </div>
                
                <div class="source-export-transform-section">
                    <h3>Back Image</h3>
                    <div class="source-export-transform-row">
                        <label class="toggle-item">
                            <input type="checkbox" id="source-back-flip-h" checked>
                            <span class="toggle-label">Flip horizontal</span>
                        </label>
                        <label class="toggle-item">
                            <input type="checkbox" id="source-back-flip-v">
                            <span class="toggle-label">Flip vertical</span>
                        </label>
                        <label class="toggle-item">
                            <span class="toggle-label">Rotate:</span>
                            <select id="source-back-rotate">
                                <option value="0">0Â°</option>
                                <option value="90">90Â° CW</option>
                                <option value="180">180Â°</option>
                                <option value="-90">90Â° CCW</option>
                            </select>
                        </label>
                    </div>
                </div>

                <button type="button" id="source-export-apply" class="btn btn-primary" style="width: 100%; margin-top: 16px;">Export</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal" hidden>
        <div class="modal-overlay" id="help-modal-overlay"></div>
        <div class="modal-content">
            <button class="modal-close" id="help-modal-close" title="Close">&times;</button>
            <h2>How to Use Foldproof</h2>
            <div class="help-content">
                <section class="help-section">
                    <h3>Getting Started</h3>
                    <p><strong>Upload Images:</strong> Drag and drop or click to upload your front and back design images. Supports PNG, JPG, WebP, and PDF files.</p>
                    <ul>
                        <li><strong>Multi-page PDFs:</strong> If your PDF has 2 pages, they'll automatically fill front and back slots. For PDFs with more pages, use the page selector to choose which page to display.</li>
                        <li><strong>Swap Images:</strong> Click the arrow button between upload zones to swap front and back images.</li>
                        <li><strong>Remove Images:</strong> Click the Ã— button to remove an uploaded image.</li>
                    </ul>
                </section>

                <section class="help-section">
                    <h3>Paper Size</h3>
                    <p>Choose from preset sizes or enter custom dimensions. Supports fractional inches (e.g., 8 1/2 Ã— 11).</p>
                    <p><strong>Autofit Image:</strong> When disabled, paper size automatically adjusts to match your uploaded image's dimensions (useful for SVGs with embedded size data).</p>
                </section>

                <section class="help-section">
                    <h3>Fold Types</h3>
                    <p>Select from the sidebar dropdown or use the icon buttons in the viewport:</p>
                    <ul>
                        <li><strong>Bi-Fold:</strong> Standard half-fold (2 panels)</li>
                        <li><strong>Tri-Fold Z-Fold:</strong> Accordion-style fold (3 panels)</li>
                        <li><strong>Tri-Fold Roll:</strong> Letter-style fold (3 panels)</li>
                        <li><strong>Gate Fold:</strong> Two panels fold inward to meet in the center</li>
                        <li><strong>Double Gate Fold:</strong> Four panels â€” outer panels fold inward, then the whole piece folds in half at the spine</li>
                    </ul>
                    <p><strong>Orientation:</strong> Switch between vertical and horizontal using the buttons below the fold type icons or the dropdown in the sidebar.</p>
                </section>

                <section class="help-section">
                    <h3>3D Viewport Controls</h3>
                    <ul>
                        <li><strong>Rotate:</strong> Click and drag to orbit around the model</li>
                        <li><strong>Zoom:</strong> Scroll or pinch to zoom in/out</li>
                        <li><strong>Pan:</strong> Right-click and drag (or two-finger drag on trackpad)</li>
                    </ul>
                </section>

                <section class="help-section">
                    <h3>Animation Controls</h3>
                    <p><strong>Fold Progress:</strong> Drag the slider to manually fold/unfold (-100% to 100%). Double-click to reset to 0%.</p>
                    <p><strong>Play/Pause:</strong> Automatically animate the folding sequence.</p>
                    <p><strong>Speed:</strong> Adjust animation speed (0.1x to 3x). Double-click to reset to 1x.</p>
                    <p><strong>Fold/Unfold Buttons:</strong> Quickly animate to fully folded or unfolded state.</p>
                </section>

                <section class="help-section">
                    <h3>Guides & Rulers</h3>
                    <p>Toggle visual guides to help with print layout:</p>
                    <ul>
                        <li><strong>Trim Line:</strong> Final cut edge (red)</li>
                        <li><strong>Bleed Area:</strong> Extra space for printing (orange, adjustable margin)</li>
                        <li><strong>Safe Zone:</strong> Keep important content inside (green, adjustable margin)</li>
                        <li><strong>Fold Lines:</strong> Where the paper folds (blue)</li>
                        <li><strong>Ruler:</strong> Measurement marks with optional labels (purple in light mode, lighter purple in dark mode)</li>
                        <li><strong>Grid:</strong> Background reference grid (can be toggled on/off)</li>
                    </ul>
                    <p><strong>Tip:</strong> Double-click bleed or safe zone sliders to reset to default values.</p>
                </section>

                <section class="help-section">
                    <h3>Image Adjustments</h3>
                    <ul>
                        <li><strong>Reflect buttons:</strong> Use the flip buttons next to each image row to mirror horizontally (â†”) or vertically (â†•). Active buttons are highlighted.</li>
                    </ul>
                </section>

                <section class="help-section">
                    <h3>Screenshot & Export</h3>
                    <p>Two buttons in the top-right of the viewport:</p>
                    <ul>
                        <li><strong>Screenshot:</strong> Capture the current 3D view as JPG, PNG, PDF, or Animated GIF with optional background, guides, and grid. The GIF option records the full fold animation cycle (-100% to 100%) from the current camera angle.</li>
                        <li><strong>Export:</strong> Opens a modal to export full-resolution source images with transformations (format, flips, rotation) at viewport size and orientation</li>
                    </ul>
                </section>

                <section class="help-section">
                    <h3>Theme</h3>
                    <p>Toggle between light and dark mode using the sun/moon icon. Your preference is saved automatically.</p>
                </section>
            </div>
        </div>
    </div>

    <!-- PDF.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.min.mjs" type="module"></script>
    
    <!-- Import Map for ES Modules -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/",
            "pdfjs-dist": "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.0.379/pdf.min.mjs",
            "jspdf": "https://esm.sh/jspdf@2.5.1",
            "gifenc": "https://esm.sh/gifenc@1.0.3"
        }
    }
    </script>
    
    <!-- Application Scripts -->
    <script type="module" src="js/main.js"></script>
</body>
</html>
